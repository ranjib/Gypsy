---
name: chef
materials:
  - type: github
    uri: chef/chef
container: wily
scripts:
  - command: wget -c http://cache.ruby-lang.org/pub/ruby/2.2/ruby-2.2.3.tar.gz
  - command: tar -zxvf ruby-2.2.3.tar.gz -C /tmp
  - command: bash ./configure --enable-load-relative --prefix=/opt/chef
    cwd: /tmp/ruby-2.2.3
  - command: make
    cwd: /tmp/ruby-2.2.3
  - command: make install
    cwd: /tmp/ruby-2.2.3
  - command: /opt/chef/bin/gem install bundler fpm
  - command: git clone https://github.com/chef/chef.git
    cwd: /tmp
  - command: /
    env:
      path: /opt/chef/bin:/bin:/usr/bin:/sbin:/usr/sbin


  - command: /opt/chef/bin/fpm -s dir -t deb -n chef -v 13.6 /opt/chef
artifacts:
  - name: chef.deb
    path: /opt/gospace/bin/influxd
